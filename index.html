<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Service Snake</title>
  <style>
    body { 
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif; 
      text-align: center; 
      background: linear-gradient(to bottom, #0b0b0b, #1c1c1c); 
      color: #e0e0e0; 
      margin:0; 
      padding:0;
    }
    h1 {
      color: #00a1e0; 
      margin: 20px 0;
    }
    #gameCanvas { 
      background: #111; 
      display: block; 
      margin: 0 auto; 
      border: 4px solid #00a1e0; 
      border-radius: 12px;
      width: 90vw;
      height: 90vw;
      max-width: 400px;
      max-height: 400px;
    }
    #controls {
      width: 90vw;
      max-width: 300px;
      margin: 20px auto 40px;
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(2, 1fr);
      gap: 10px;
    }
    #up    { grid-column: 2; grid-row: 1; }
    #left  { grid-column: 1; grid-row: 2; }
    #down  { grid-column: 2; grid-row: 2; }
    #right { grid-column: 3; grid-row: 2; }

    button {
      background: #00a1e0;
      border: none;
      color: #fff;
      font-size: 24px;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
      transition: all 0.2s ease-in-out;
      width: 100%;
      aspect-ratio: 1/1;
    }
    button:active {
      transform: scale(0.95);
      background: #007bbf;
    }
    #info p {
      margin: 5px 0;
      font-size: 14px;
      color: #c0c0c0;
    }
  </style>
</head>
<body>
  <h1>Service Snake</h1>

  <canvas id="gameCanvas"></canvas>

  <div id="controls">
    <button id="up">‚Üë</button>
    <button id="left">‚Üê</button>
    <button id="down">‚Üì</button>
    <button id="right">‚Üí</button>
  </div>

  <div id="info">
    <p id="score">Pontua√ß√£o: 0</p>
    <p id="highscore">Recorde: 0</p>
    <p>Use Cursor ou Toque para Jogar.</p>
  </div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

const gridCount = 10;
let gridSize;

function resizeCanvas() {
  const size = Math.min(window.innerWidth*0.9, 400);
  canvas.width = size;
  canvas.height = size;
  gridSize = size / gridCount;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

// üîπ Caminhos relativos (crie pasta /assets com estas imagens no GitHub)
const headImgs = ["assets/head1.png", "assets/head2.png"];
const foodImgs = ["assets/food1.png", "assets/food2.png", "assets/food3.png"];

function loadImages(urls) {
  return urls.map(src => {
    let img = new Image();
    img.src = src;
    return img;
  });
}
const heads = loadImages(headImgs);
const foods = loadImages(foodImgs);

let snake = [{x:5, y:5}];
let snakeDir = {x:0, y:0};
let headImg = heads[Math.floor(Math.random()*heads.length)];
let food = {x:2, y:2, img: foods[Math.floor(Math.random()*foods.length)]};
let score = 0;

// üîπ High Score salvo no navegador
let highScore = localStorage.getItem("snakeHighScore") 
                ? parseInt(localStorage.getItem("snakeHighScore")) 
                : 0;
document.getElementById("highscore").textContent = "Recorde: " + highScore;

function placeFood() {
  let x, y;
  do {
    x = Math.floor(Math.random() * gridCount);
    y = Math.floor(Math.random() * gridCount);
  } while (snake.some(s => s.x === x && s.y === y));
  food = {x, y, img: foods[Math.floor(Math.random()*foods.length)]};
}

function update() {
  if (snakeDir.x === 0 && snakeDir.y === 0) { draw(); return; }

  let head = {x: snake[0].x + snakeDir.x, y: snake[0].y + snakeDir.y};
  head.x = (head.x + gridCount) % gridCount;
  head.y = (head.y + gridCount) % gridCount;

  if (snake.some(s => s.x === head.x && s.y === head.y)) { resetGame(); return; }

  snake.unshift(head);

  if (head.x === food.x && head.y === food.y) {
    score++; 
    document.getElementById("score").textContent = "Pontua√ß√£o: " + score;

    if (score > highScore) {
      highScore = score;
      localStorage.setItem("snakeHighScore", highScore);
      document.getElementById("highscore").textContent = "Recorde: " + highScore;
    }

    placeFood();
    if (Math.random() < 0.3) {
      headImg = heads[Math.floor(Math.random()*heads.length)];
    }
  } else {
    snake.pop();
  }

  draw();
}

function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.drawImage(food.img, food.x*gridSize, food.y*gridSize, gridSize, gridSize);

  for (let i=1; i<snake.length; i++) {
    let seg = snake[i];
    ctx.fillStyle = "#00ff99";
    ctx.fillRect(seg.x*gridSize, seg.y*gridSize, gridSize, gridSize);
  }
  ctx.drawImage(headImg, snake[0].x*gridSize, snake[0].y*gridSize, gridSize, gridSize);
}

function resetGame() {
  snake = [{x:5, y:5}];
  snakeDir = {x:0, y:0};
  score = 0; 
  document.getElementById("score").textContent = "Pontua√ß√£o: " + score;
  headImg = heads[Math.floor(Math.random()*heads.length)];
  placeFood();
}

window.addEventListener('keydown', e => {
  switch(e.key) {
    case 'ArrowUp': if(snakeDir.y!==1) snakeDir={x:0,y:-1}; break;
    case 'ArrowDown': if(snakeDir.y!==-1) snakeDir={x:0,y:1}; break;
    case 'ArrowLeft': if(snakeDir.x!==1) snakeDir={x:-1,y:0}; break;
    case 'ArrowRight': if(snakeDir.x!==-1) snakeDir={x:1,y:0}; break;
  }
});

document.getElementById('up').addEventListener('click', () => { if(snakeDir.y!==1) snakeDir={x:0,y:-1}; });
document.getElementById('down').addEventListener('click', () => { if(snakeDir.y!==-1) snakeDir={x:0,y:1}; });
document.getElementById('left').addEventListener('click', () => { if(snakeDir.x!==1) snakeDir={x:-1,y:0}; });
document.getElementById('right').addEventListener('click', () => { if(snakeDir.x!==-1) snakeDir={x:1,y:0}; });

resetGame();
setInterval(update, 200);
</script>

</body>
</html>
